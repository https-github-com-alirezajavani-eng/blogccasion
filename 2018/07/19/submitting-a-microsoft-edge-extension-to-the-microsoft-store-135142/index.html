<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,viewport-fit=cover"><meta property="twitter:account_id" content="1510101733"><meta name="description" content="The personal blog of Thomas Steiner"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="monetization" content="$pay.stronghold.co/1a1c51358527bef4dc7bcc3e92b155ec07a"><meta name="theme-color"><link rel="icon" href="/static/icon.png"><link rel="apple-touch-icon" href="/static/icon.png"><link rel="canonical" href="/blogccasion/2018/07/19/submitting-a-microsoft-edge-extension-to-the-microsoft-store-135142/"><link rel="alternate" href="/blogccasion/feed/feed.xml" type="application/atom+xml" title="Blogccasion"><link rel="author" href="https://tomayac.com/humans.txt" type="text/plain"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet"><script>if (window.matchMedia('(prefers-color-scheme: dark)').media === 'not all') {
        document.documentElement.style.display = 'none';
        document.head.insertAdjacentHTML(
            'beforeend',
            '<link rel="stylesheet" href="/light.css" onload="document.documentElement.style.display = \'\'">'
        );
      }</script><link rel="stylesheet" href="/css/light.css" media="(prefers-color-scheme:light),(prefers-color-scheme:no-preference)"><link rel="stylesheet" href="/css/dark.css" media="(prefers-color-scheme:dark)"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/prism-theme.css"><link rel="webmention" href="https://webmention.io/blog.tomayac.com/webmention"><link rel="pingback" href="https://webmention.io/blog.tomayac.com/xmlrpc"><link rel="manifest" href="/manifest.webmanifest"><title>Submitting a Microsoft Edge extension to the Microsoft Store</title><script type="module" src="/js/script.mjs"></script><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@tomayac"><meta name="twitter:title" content="Submitting a Microsoft Edge extension to the Microsoft Store"><meta name="twitter:description" content="The personal blog of Thomas Steiner"><meta name="twitter:image" content="https://blog.tomayac.com/blogccasion/2018/07/19/submitting-a-microsoft-edge-extension-to-the-microsoft-store-135142/screenshot-dark.png"><meta property="og:url" content="https://blog.tomayac.com/blogccasion/2018/07/19/submitting-a-microsoft-edge-extension-to-the-microsoft-store-135142/"><meta property="og:type" content="article"><meta property="og:title" content="Submitting a Microsoft Edge extension to the Microsoft Store"><meta property="og:description" content="The personal blog of Thomas Steiner"><meta property="og:image" content="https://blog.tomayac.com/blogccasion/2018/07/19/submitting-a-microsoft-edge-extension-to-the-microsoft-store-135142/screenshot-dark.png"><script type="application/ld+json">{
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "headline": "Submitting a Microsoft Edge extension to the Microsoft Store",
        "image": "https://blog.tomayac.com/blogccasion/2018/07/19/submitting-a-microsoft-edge-extension-to-the-microsoft-store-135142/screenshot-dark.png",
        "url": "https://blog.tomayac.com/blogccasion/2018/07/19/submitting-a-microsoft-edge-extension-to-the-microsoft-store-135142/",
        "datePublished": "2018-07-19T13:51:42.000Z",
        "dateCreated": "2018-07-19T13:51:42.000Z",
        "dateModified": "2018-07-19T13:51:42.000Z",
        "description": "The personal blog of Thomas Steiner",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://blog.tomayac.com/"
        },
        "author": {
          "@type": "Person",
          "name": "Thomas Steiner",
          "email": "steiner.thomas@gmail.com",
          "image": "https://blog.tomayac.com/static/icon.png"
        },
        "publisher": {
          "@type": "Organization",
          "name": "Thomas Steiner",
          "email": "steiner.thomas@gmail.com",
          "logo": {
            "@type": "ImageObject",
            "url": "https://blog.tomayac.com/static/icon.png"
          }
        }
      }</script></head><body><div class="container"><header><a href="/"><h1>blogccasion</h1></a><div class="header-footer-text"><span lang="fr"><strong>l'occasion</strong> <em>f</em> — </span><span lang="de">Gelegenheit</span> <em>f</em>, die ~ , der ~; <em>bei Gelegenheit</em> — <span lang="fr"><strong>à l'occasion</strong></span></div></header><main class="tmpl-post"><article><header><a href="/blogccasion/2018/07/19/submitting-a-microsoft-edge-extension-to-the-microsoft-store-135142/"><h1>Submitting a Microsoft Edge extension to the Microsoft Store</h1></a><div class="metadata post-date"><img class="author" src="/images/thomas_steiner.jpg" alt="Thomas Steiner headshot"><p>By <a href="/about/">Thomas Steiner</a>. Written on <time datetime="2018-07-19T13:51:42.000Z">Thu Jul 19 2018</time>. <a href="/tags/Technical" class="tag-item"><b>Technical</b></a></p></div></header><p>This is a bit of a rant, and a bit of a process documentation. I'm trying to submit the <a href="https://github.com/google/service-worker-detector">Service Worker Detector</a> browser extension to the <a href="https://www.microsoft.com/en-us/store/b/home">Microsoft Store</a>, so it can be one of the <a href="https://www.microsoft.com/store/collections/edgeextensions/">Edge extensions</a> everyone can easily install via a few mouse clicks. I have to say, the process is somewhat involved.</p><p><img width="1200" height="675" src="/images/sw-detector-edge.jpg"></p><p>To start, it's whitelist only, so you have to <a href="http://aka.ms/extension-request">apply via the extension submission form</a>, which I did. For me, nothing really happened for a long time, so I chased down someone from the helpful <a href="https://twitter.com/MSEdgeDev">@MSEdgeDev team</a> who pulled some internal strings. Ultimately I got an email invite that I may now submit to the Store. While you can <a href="https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/creating-an-extension">develop and test extensions locally</a> mostly the Chrome way (that I am quite familiar with) by just loading the extension in developer mode, the process gets more complex for the actual Store submission (and required testing):</p><ul><li>First, you need to <a href="https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/packaging/using-manifoldjs-to-package-extensions">package the extension with ManifoldJS</a> so it becomes an app, so far so good.<pre><code>manifoldjs -l debug -p edgeextension -f edgeextension -m service-worker-detector/manifest.json
manifoldjs -l debug -p edgeextension package SWDetector/edgeextension/manifest/</code></pre></li><li>Next, you need to <a href="https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/packaging/running-the-windows-app-certification-kit">test the resulting app package locally</a> with the <em>Windows App Certification Kit</em>, also no problem. I just went for the <a href="https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/windows-app-certification-kit#validate-your-windows-app-using-the-windows-app-certification-kit-from-a-command-line">interactive way</a> with the graphical user interface tool. This test caught an issue with icons, where the syntax <code>"browser_action": {"default_icon": "icon.png"}</code> or <code>"page_action": {"default_icon": "icon.png"}</code> would not work, but where <a href="https://docs.microsoft.com/en-us/microsoft-edge/extensions/api-support/supported-manifest-keys#browser_action-or-page_action-keys">explicit sizes are required</a> instead.</li><li>Then, you need to <a href="https://docs.microsoft.com/en-us/windows/uwp/packaging/create-certificate-package-signing">create and export a self-signed certificate</a> (the CertStoreLocation parameter actually ends in just "My", it's not a typo):<pre><code>New-SelfSignedCertificate -Type Custom -Subject "CN=SUP3R-S3CRET-ID-TH1NG" -KeyUsage DigitalSignature -FriendlyName "Thomas Steiner" -CertStoreLocation "Cert:\LocalMachine\My"</code></pre>This returns a thumb ID that you need for the export step:<pre><code>$pwd = ConvertTo-SecureString -String mySecretPassword -Force -AsPlainText
Export-PfxCertificate -cert "Cert:\LocalMachine\My\SUP3RS3CR3TTHUMBPR1NT" -FilePath self-signed-certificate.pfx -Password $pwd</code></pre></li><li>You need this certificate in order to <a href="https://docs.microsoft.com/en-us/windows/uwp/packaging/sign-app-package-using-signtool">sign your app package</a> created by ManifoldJS, which requires you to download and install the <a href="https://developer.microsoft.com/en-us/windows/downloads/windows-10-sdk">Windows 10 SDK</a> (and obviously an actual Windows 10 installation). Windows PowerShell would not recognize the installed SignTool, so I had to use the <a href="https://stackoverflow.com/questions/31869552/how-to-install-signtool-exe-for-windows-10">explicit path</a>:<pre><code>&amp; 'C:\Program Files (x86)\Windows Kits\10\bin\x64\signtool.exe' sign /fd SHA256 /a /f self-signed-certificate.pfx /p password edgeExtension.appx</code></pre></li><li>Ultimately, you need to <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/certmgr">add the self-signed certificate to your trusted root certificates</a>, but it didn't work as described, so I ended up right-clicking the certificate file in Windows Explorer and fat-fingering around in the trust settings in the Details tab until it worked and I could install the Edge extension <code>.appx</code> file by double-clicking it.</li></ul><p>I'm now in the third iteration with their store review team where it's all working fine for me locally, but where they say it crashes on their side. Let's see how it ends. I guess the core issue is that <a href="https://www.npmjs.com/package/manifoldjs">ManifoldJS</a> can do a lot of things to shield me from something, something <a href="https://en.wikipedia.org/wiki/Universal_Windows_Platform">Windows UWP apps</a>, but where eventually you still need to read the <a href="https://docs.microsoft.com/en-us/windows/uwp/packaging/">UWP packaging docs</a> for the Microsoft Store submission that are clearly not written with extension developers in mind, but rather for regular Windows app developers.</p><p><img width="1200" height="649" src="/images/sw-detector-store.jpg"></p><p>Oh, and another thing I just realized: Edge <a href="https://caniuse.com/#feat=details">doesn't know</a> the <code>&lt;details&gt;</code> and <code>&lt;summary&gt;</code> elements. It <a href="https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/13120279/">used to work</a> and <em>"[t]he implementation of this feature had shipped, but its quality was found lacking, hence this implementation was removed before Edge shipped last release. There currently [as of January 22, 2018] isn't [a] plan [Francois R. from the Microsoft Edge Team is] aware of to bring the feature back in the next update."</em> Sad. It is, however, mentioned as <em>Under Consideration</em> on the corresponding <a href="https://developer.microsoft.com/en-us/microsoft-edge/platform/status/detailssummary/?q=details">Edge Platform status page</a> with high priority, so here is hoping</p><p>[<span class="edit-on-github">You can <a href="https://github.com/tomayac/blogccasion/tree/master/./posts/2018/2018-07-19_submitting-a-microsoft-edge-extension-to-the-microsoft-store.html" rel="nofollow">edit this page on GitHub</a>.</span>]</p></article></main><nav><h2>Pages</h2><ul><li><a class="nav-item" href="/blogccasion/">Home</a></li><li><a class="nav-item" href="/blogccasion/posts/">Archive</a></li><li><a class="nav-item" href="/blogccasion/about/">About</a></li></ul><h2>Tags</h2><ul><li><a href="/blogccasion/tags/Technical/" class="tag-item">Technical</a></li><li><a href="/blogccasion/tags/France/" class="tag-item">France</a></li><li><a href="/blogccasion/tags/Work/" class="tag-item">Work</a></li><li><a href="/blogccasion/tags/Private/" class="tag-item">Private</a></li><li><a href="/blogccasion/tags/Political/" class="tag-item">Political</a></li></ul></nav><svg xmlns="http://www.w3.org/2000/svg"><symbol id="icon-rss" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></symbol><symbol id="icon-twitter" aria-label="Twitter" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1da1f3"/><path fill="#fff" d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></symbol><symbol id="icon-mastodon" aria-label="Mastodon" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%"/><path d="M409 290c-5 24-43 50-85 56-86 11-137-6-137-6 3 13-4 54 70 52 31 0 58-7 58-7l2 27c-51 24-107 15-140 6-67-17-79-90-81-162v-59c0-74 49-96 49-96 50-24 180-22 222 0 0 0 49 22 49 96 0 0 1 55-7 93" fill="#3088d4"/><path d="M358 202v91h-35v-88c0-18-8-27-23-27-18 0-27 11-27 33v47h-34v-47c0-22-9-33-27-33-15 0-23 9-23 27v88h-35v-91c0-18 5-60 52-60 39 0 50 37 50 37s10-37 50-37c45 0 52 42 52 60"/></symbol><symbol id="icon-pgp" aria-label="PGP Public Key" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#29303d"/><g fill="#29303d"><path stroke="#e0e4eb" stroke-width="32" d="M346 214v-37c0-123-180-123-180 0v37"/><rect fill="#ff0" height="210" rx="5%" width="280" x="115" y="210"/><circle cx="256" cy="296" r="28"/><path d="M262 296h-12l-16 69h44"/></g></symbol><symbol id="icon-github" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></symbol></svg><aside><h2>Related</h2><ul><li><a class="aside-item" href="/blogccasion/feed/feed.xml" rel="me"><svg class="icon"><use xlink:href="#icon-rss"></use></svg> Blog Feed</a></li><li><a class="aside-item" href="https://twitter.com/tomayac" rel="me"><svg class="icon"><use xlink:href="#icon-twitter"></use></svg> Twitter</a></li><li><a class="aside-item" href="https://tomayac.com/tweets" rel="me"><svg class="icon"><use xlink:href="#icon-twitter"></use></svg> Tweet Archive</a></li><li><a class="aside-item" href="https://toot.cafe/@tomayac" rel="me"><svg class="icon"><use xlink:href="#icon-mastodon"></use></svg> Mastodon</a></li><li><a class="aside-item" href="https://github.com/tomayac" rel="me"><svg class="icon"><use xlink:href="#icon-github"></use></svg> GitHub</a></li><li><a class="aside-item" href="/pgp_public_key.asc"><svg class="icon"><use xlink:href="#icon-pgp"></use></svg> Public Key</a></li></ul></aside><footer id="footer"><ul class="header-footer-text"><li>© 2005–2019 <a class="footer-link" href="/about">Thomas Steiner</a>.</li><li>Distributed under <a class="footer-link" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</li><li>Contact and required <a class="footer-link" href="/about/">legal info</a>.</li></ul><dark-mode-toggle permanent dark="Light Theme" light="Dark Theme"></dark-mode-toggle><a class="validator" href="https://validator.w3.org/nu/?doc=https://blog.tomayac.com/blogccasion/2018/07/19/submitting-a-microsoft-edge-extension-to-the-microsoft-store-135142/"><img src="/static/validhtml5.svg" width="88" height="31" alt="Valid HTML5 badge"></a></footer></div></body></html>