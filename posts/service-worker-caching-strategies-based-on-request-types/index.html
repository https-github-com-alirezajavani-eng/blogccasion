<!doctype html lang="en">
<html ⚡>
  <head>
    <meta charset="utf-8">
    <title>Service Worker Caching Strategies Based on Request Types</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <meta property="twitter:account_id" content="1510101733">
    <meta name="amp-google-client-id-api" content="googleanalytics">
    <meta name="Description" content="Instead of purely relying on URL-based pattern matching, also consider leveraging the lesser-known — but super useful — Request.destination property in your service worker to determine the type…">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="canonical" href="/blogccasion/posts/service-worker-caching-strategies-based-on-request-types/">
    <link rel="alternate" href="/blogccasion/feed/feed.xml" type="application/atom+xml" title="Blogccasion">
    <link type="text/plain" rel="author" href="https://tomayac.com/humans.txt">
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>
      #header,
      #navigation {
        background-color: #eee;
        margin: 0 0 .5em
      }

      #content,
      #header {
        width: 100%;
        border: 1px dashed silver
      }

      #aside,
      #content,
      #footer,
      #header,
      #navigation {
        border: 1px dashed silver
      }

      #content a,
      #footer a {
        padding: .2em;
        text-decoration: none
      }

      #aside a,
      #content a,
      #content>h3 a,
      #footer a,
      #navigation a {
        text-decoration: none
      }

      #aside a:hover,
      #aside a:link,
      #aside a:visited,
      #content h2,
      #content h3,
      #content>h3 a,
      #footer a,
      body {
        color: #000
      }

      html {
        box-sizing: border-box
      }

      *,
      ::after,
      ::before {
        box-sizing: inherit
      }

      body {
        background-color: #fff;
        font-size: 12pt;
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif
      }

      #blog,
      #ccasion {
        font-size: 1.5em;
        position: absolute;
        font-weight: 700
      }

      #blog {
        top: 0;
        left: 1em;
        z-index: 1;
        color: #ffd700
      }

      #ccasion {
        top: .05em;
        left: 2.12em;
        z-index: 2;
        color: #ff8032
      }

      #login {
        position: absolute;
        top: .05em;
        right: .5em
      }

      #header {
        font-size: 1.2em;
        max-width: 1400px;
        padding: 0;
        overflow: hidden
      }

      #aside h2,
      #navigation h2 {
        font-size: .9em
      }

      #container {
        display: -webkit-flex;
        display: flex;
        margin: 0 .5em;
        max-width: calc(1400px - .5em)
      }

      @media (min-width:480px) {
        #container {
          -webkit-flex-direction: row;
          flex-direction: row
        }
      }

      @media (max-width:480px) {
        #container {
          -webkit-flex-direction: column;
          flex-direction: column
        }
      }

      #navigation-aside {
        display: -webkit-flex;
        display: flex
      }

      @media (min-width:480px) {
        #navigation-aside {
          -webkit-flex-direction: column;
          flex-direction: column
        }
      }

      #navigation {
        width: 120px
      }

      #navigation h2 {
        margin: 0;
        background-color: #ffd700
      }

      #navigation a {
        display: block;
        overflow-x: hidden;
        padding: 0 0 .2em;
        font-weight: 700;
        color: #000
      }

      .category0:hover {
        background-color: #c0c0ff
      }

      .category1:hover {
        background-color: #ff8032
      }

      .category2:hover {
        background-color: #80ff00
      }

      .category3:hover {
        background-color: #ff0080
      }

      .category4:hover {
        background-color: #ff0
      }

      .category5:hover {
        background-color: #80ff80
      }

      .category6:hover {
        background-color: #ff8080
      }

      .category7:hover {
        background-color: #c0ff80
      }

      .category8:hover {
        background-color: #ffc080
      }

      #aside h2,
      #content h2 {
        background-color: #ffd700;
        margin: 0
      }

      #aside a:hover,
      #footer a:hover {
        background-color: #80ffff
      }

      #aside {
        width: 120px;
        margin: 0 .5em .5em 0;
        background-color: #eee;
        overflow-x: hidden
      }

      #aside svg {
        vertical-align: middle
      }

      #aside p {
        margin: .5em
      }

      #aside a {
        display: block;
        padding: 0;
        font-size: 1em;
        font-weight: 400
      }

      #content a,
      #content h2,
      #content h3,
      #footer a {
        font-weight: 700
      }

      #content {
        margin: 0;
        text-align: justify
      }

      #content h2 {
        font-size: 1.2em
      }

      #content h3 {
        font-size: 1.1em;
        margin: 0;
        background-color: #ff8032
      }

      #content p {
        font-size: 1em;
        margin: .5em 0;
        text-align: justify
      }

      #content img {
        margin: .5em 1em;
        max-width: 100%;
      }

      #content hr {
        height: 1px;
        text-align: left;
        margin-left: 0;
        border: 1px solid silver
      }

      #content small {
        font-size: .9em;
        padding: .5em 0
      }

      #content pre {
        font-family: monospace;
        color: #00f;
        background-color: #ffa;
        margin: 2.5em;
        font-size: .9em;
        white-space: pre-wrap;
        text-overflow: ellipsis;
        overflow-x: scroll
      }

      #content a {
        display: inline
      }

      #content a:link {
        color: #00f
      }

      #content a:visited {
        color: #00008b
      }

      #content a:hover {
        color: #00f;
        text-decoration: underline
      }

      #footer {
        max-width: 1400px;
        margin: .5em 0 0;
        padding: .5em
      }

      #footer ul {
        list-style: none
      }

      #footer li::before {
        content: "» "
      }

      .blogPost {
        padding: .5em
      }

      .commentForm,
      .commentList {
        display: none
      }

      ul {
        padding-left: .5em;
        list-style-position: inside
      }

      amp-iframe,
      iframe {
        max-width: 533px
      }

      @media (max-width:480px) {
        #navigation-aside {
          -webkit-flex-direction: row;
          flex-direction: row
        }
        #navigation {
          width: 50%
        }
        #aside>amp-img,
        #navigation amp-img {
          -webkit-transform-origin: left;
          -webkit-transform: scaleX(2);
          transform-origin: left;
          transform: scaleX(2)
        }
        #aside {
          width: 50%;
          margin: 0 0 .5em .5em
        }
        amp-iframe,
        amp-img,
        iframe,
        img {
          max-width: 100%;
          layout: responsive
        }
      }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
  </head>
  <body>
    <header id="header">
      <a href="/"><amp-img src="/static/city.jpg" alt="" width="1400" height="20"></amp-img></a>
      <a href="/"><div id="blog">blog</div><div id="ccasion">occasion</div></a>
      &nbsp;<strong>l'occasion</strong> <em>f</em> - Gelegenheit <em>f</em>, die ~ , der ~; <em>bei Gelegenheit</em> - <strong>&agrave; l'occasion</strong>
    </header>
    <div id="container">
      <div id="navigation-aside">

        <nav id="navigation">
          <h2>Tags</h2>
          <a href="/"><amp-img src="/static/mountains_sunrise.jpg" alt="" width="120" height="23"></amp-img></a>
          
            
            <a href="/blogccasion/tags/Private/" class="tag">Private</a>
          
            
            <a href="/blogccasion/tags/Technical/" class="tag">Technical</a>
          
            
            <a href="/blogccasion/tags/France/" class="tag">France</a>
          
            
            <a href="/blogccasion/tags/Work/" class="tag">Work</a>
          
            
            <a href="/blogccasion/tags/Political/" class="tag">Political</a>
          

          <h2>Pages</h2>
          <a href="/"><amp-img src="/static/mountains_sunrise.jpg" alt="" width="120" height="23"></amp-img></a><a class="nav-item" href="/blogccasion/">Home</a><a class="nav-item" href="/blogccasion/posts/">Archive</a><a class="nav-item" href="/blogccasion/about/">About</a></nav>

        <aside id="aside">
          <h2>Related</h2>
          <amp-img src="/static/palms.jpg" alt="" width="120" height="23"></amp-img>
          <div>
            <p>
              <a href="/blogccasion/feed/feed.xml" rel="me"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="16" height="16" viewBox="0 0 256 256"><rect width="246" height="246" rx="50" ry="50" x="5" y="5" fill="#F49C52"/><rect width="236" height="236" rx="47" ry="47" x="10" y="10" fill="#F49C52"/><circle cx="68" cy="189" r="24" fill="#FFF"/><path d="M160 213h-34a82 82 0 0 0-82-82v-34a116 116 0 0 1 116 116zM184 213A140 140 0 0 0 44 73V38a175 175 0 0 1 175 175z" fill="#FFF"/></svg> Blog Feed</a>
            </p>
            <p>
               <a href="https://twitter.com/tomayac" rel="me"><svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" height="16" width="16" version="1.1" viewBox="0 0 182.7 150.7"><defs><clipPath clipPathUnits="userSpaceOnUse"><path d="m0 10h1366.9v1110.9h-1366.9z"/></clipPath></defs><g transform="matrix(1.3333 0 0 -1.3333 0 150.67)"><g transform="scale(.1)"><g clip-path="url(#clipPath20)"><path d="m1366.9 989.4c-50.3-22.3-104.3-37.4-161-44.2 57.9 34.7 102.3 89.7 123.3 155.2-54.2-32.1-114.2-55.5-178.1-68-51.1 54.5-124 88.6-204.7 88.6-154.9 0-280.4-125.5-280.4-280.4 0-22 2.5-43.4 7.3-63.9-233.1 11.7-439.7 123.4-578 293-24.1-41.4-38-89.6-38-141 0-97.3 49.5-183.1 124.8-233.4-46 1.4-89.2 14.1-127 35.1 0-1.2 0-2.3 0-3.5 0-135.9 96.7-249.2 225-275-23.5-6.4-48.3-9.8-73.9-9.8-18.1 0-35.6 1.7-52.8 5 35.7-111.4 139.3-192.5 262-194.8-96.1-75.2-217-120-348.4-120-22.6 0-45 1.3-66.9 3.9 124.2-79.6 271.6-126 429.9-126 515.8 0 797.9 427.3 797.9 797.9 0 12.2-0.3 24.2-0.8 36.3 54.8 39.6 102.3 89 139.9 145.2" fill="#55ACEE"/></g></g></g></svg> @tomayac</a>
            </p>
            <p>
               <a href="https://tomayac.com/tweets" rel="me"><svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" height="16" width="16" version="1.1" viewBox="0 0 182.7 150.7"><defs><clipPath clipPathUnits="userSpaceOnUse"><path d="m0 10h1366.9v1110.9h-1366.9z"/></clipPath></defs><g transform="matrix(1.3333 0 0 -1.3333 0 150.67)"><g transform="scale(.1)"><g clip-path="url(#clipPath20)"><path d="m1366.9 989.4c-50.3-22.3-104.3-37.4-161-44.2 57.9 34.7 102.3 89.7 123.3 155.2-54.2-32.1-114.2-55.5-178.1-68-51.1 54.5-124 88.6-204.7 88.6-154.9 0-280.4-125.5-280.4-280.4 0-22 2.5-43.4 7.3-63.9-233.1 11.7-439.7 123.4-578 293-24.1-41.4-38-89.6-38-141 0-97.3 49.5-183.1 124.8-233.4-46 1.4-89.2 14.1-127 35.1 0-1.2 0-2.3 0-3.5 0-135.9 96.7-249.2 225-275-23.5-6.4-48.3-9.8-73.9-9.8-18.1 0-35.6 1.7-52.8 5 35.7-111.4 139.3-192.5 262-194.8-96.1-75.2-217-120-348.4-120-22.6 0-45 1.3-66.9 3.9 124.2-79.6 271.6-126 429.9-126 515.8 0 797.9 427.3 797.9 797.9 0 12.2-0.3 24.2-0.8 36.3 54.8 39.6 102.3 89 139.9 145.2" fill="#55ACEE"/></g></g></g></svg> Tweet Archive</a>
            </p>
            <p>
              <a href="pgp_public_key.asc">🔐 PGP Public Key</a>
            </p>
          </div>
        </aside>
      </div>
      <main class="tmpl-post" id="content">
        <h2>A Look Inside the Think Tank...</h2>
        <article class="blogPost">
  <header>
    <a href="/blogccasion/posts/service-worker-caching-strategies-based-on-request-types/"><h3>Service Worker Caching Strategies Based on Request Types</h3></a>
    <div>
      <small>
        Created on <time datetime=""></time>
        and categorized as <a class='' href=''></a>.
      </small>
    </div>
    <div><small>Written by <b>Thomas Steiner</b>.</small></div>
    <hr>
  </header>
  <h3 id="tl%3Bdr">TL;DR <a class="direct-link" href="#tl%3Bdr" aria-hidden="true">#</a></h3>
<p>Instead of purely relying on URL-based pattern matching, also consider leveraging the lesser-known — but super useful — <code>[Request.destination](https://developer.mozilla.org/en-US/docs/Web/API/Request/destination)</code> property in your service worker to determine the type and/or caching strategy of requests. Note, though, that <code>Request.destination</code> gets set to the non-informative empty string default value for <code>XMLHttpRequest</code> or <code>fetch()</code> calls. You can play with the <code>[Request.destination](https://request-destination-playground.glitch.me/)</code><a href="https://request-destination-playground.glitch.me/">playground app</a> to see <code>Request.destination</code> in action.</p>
<h3 id="different-caching-strategies-for-different-types-of-resources">Different Caching Strategies for Different Types of Resources <a class="direct-link" href="#different-caching-strategies-for-different-types-of-resources" aria-hidden="true">#</a></h3>
<p>When it comes to establishing caching strategies for Progressive Web Apps, not all resources should be treated equally. For example, for a shopping PWA, your API calls that return live data on some items’ availabilities might be configured to use a <a href="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/#network-only">Network Only</a> strategy, your self-hosted company-owned web fonts might be configured to use a <a href="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/#cache-only">Cache Only</a> strategy, and your other HTML, CSS, JavaScript, and image resources might use a <a href="https://developers.google.com/web/fundamentals/instant-and-offline/offline-cookbook/#network-falling-back-to-cache">Network Falling Back to Cache</a> strategy.</p>
<h3 id="url-based-determination-of-the-request-type">URL-based Determination of the Request Type <a class="direct-link" href="#url-based-determination-of-the-request-type" aria-hidden="true">#</a></h3>
<p>Commonly, developers have relied on the known URL structure of their PWAs and regular expressions to determine the appropriate caching strategy for a given request. For example, here’s an excerpt of a modified code snippet courtesy of <a href="https://twitter.com/jaffathecake">Jake Archibald</a>’s <a href="https://jakearchibald.com/2014/offline-cookbook/">offline cookbook</a>:</p>
<pre><code>// In serviceworker.js
self.addEventListener('fetch', (event) =&gt; {
  // Parse the URL
  const requestURL = new URL(event.request.url);

  // Handle article URLs
  if (/^\/article\//.test(requestURL.pathname)) {
    event.respondWith(/* some response strategy */);
    return;
  }
  if (/\.webp$/.test(requestURL.pathname)) {
    event.respondWith(/* some other response strategy */);
    return;
  }
  /* … */
});
</code></pre>
<p>This approach allows developers to deal with their <a href="https://developers.google.com/speed/webp/">WebP images</a> (<em>i.e.</em>, requests that match the regular expression <code>/\.webp$/</code>) differently than with their HTML articles (<em>i.e.</em>, requests that match <code>/^\/article\//</code>). The downside of this approach is that it makes hard-coded assumptions about the URL structure of a PWA or the used MIME types’ file extensions, which creates a tight coupling between app and service worker logic. Should you move away from WebP to a future superior image format, you would need to remember to update your service worker’s logic as well.</p>
<h3 id="request.destination-based-determination-of-the-request-type"><code>Request.destination</code>-based Determination of the Request Type <a class="direct-link" href="#request.destination-based-determination-of-the-request-type" aria-hidden="true">#</a></h3>
<p>It turns out, the platform has a built-in way for determining the type of a request: it’s called <code>[Request.destination](https://fetch.spec.whatwg.org/#concept-request-destination)</code> as specified in the <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Quoting straight from the spec:</p>
<blockquote>
<p><em>“A request has an associated destination, which is the empty string,</em> <code>_&quot;audio&quot;_</code><em>,</em> <code>_&quot;audioworklet&quot;_</code><em>,</em> <code>_&quot;document&quot;_</code><em>,</em> <code>_&quot;embed&quot;_</code><em>,</em> <code>_&quot;font&quot;_</code><em>,</em> <code>_&quot;image&quot;_</code><em>,</em> <code>_&quot;manifest&quot;_</code><em>,</em> <code>_&quot;object&quot;_</code><em>,</em> <code>_&quot;paintworklet&quot;_</code><em>,</em> <code>_&quot;report&quot;_</code><em>,</em> <code>_&quot;script&quot;_</code><em>,</em> <code>_&quot;serviceworker&quot;_</code><em>,</em> <code>_&quot;sharedworker&quot;_</code><em>,</em> <code>_&quot;style&quot;_</code><em>,</em> <code>_&quot;track&quot;_</code><em>,</em> <code>_&quot;video&quot;_</code><em>,</em> <code>_&quot;worker&quot;_</code><em>, or</em> <code>_&quot;xslt&quot;_</code><em>. Unless stated otherwise it is the empty string.”</em></p>
</blockquote>
<p>The empty string default value is the biggest caveat. Essentially, you can’t determine the type of resources that are requested via the following methods:</p>
<blockquote>
<p><code>[_navigator.sendBeacon()_](https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon)</code><em>,</em> <code>[_EventSource_](https://developer.mozilla.org/en-US/docs/Web/API/EventSource)</code><em>, HTML’s</em> <code>[_&lt;a ping=&quot;&quot;&gt;_](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#attr-ping)</code> <em>and</em> <code>[_&lt;area ping=&quot;&quot;&gt;_](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/area#attr-ping)</code><em>,</em> <code>[_fetch()_](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)</code><em>,</em> <code>[_XMLHttpRequest_](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest)</code><em>,</em> <code>[_WebSocket_](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API)</code><em>, [and the]</em> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Cache"><em>Cache API</em></a></p>
</blockquote>
<p>In practice having <code>Request.destination</code> get set to the non-informative empty string default value matters the most for <code>fetch()</code> and <code>XMLHttpRequest</code>, so at least for resources requested through these techniques, it’s oftentimes back to URL-based pattern handling inside your service worker.</p>
<p>On the bright side, you can determine the type of everything else perfectly fine. I have built a little <code>[Request.destination](https://request-destination-playground.glitch.me/)</code><a href="https://request-destination-playground.glitch.me/">playground app</a> that shows some of these destinations in action. Note that for the sake of the to-be-demonstrated effect it also contains some anti-patterns like <a href="https://developers.google.com/web/fundamentals/primers/service-workers/registration">registering the service worker</a> as early as possible and actively circumventing the browser’s preloading heuristics (never do this in production).</p>
<p><img src="/images/asset-1_____.png" alt=" playground app showing different request types"></p>
<p>When you think about it, there are a huge number of ways a page can request resources to load. A <code>&lt;video&gt;</code> can load an image as its poster frame and a timed text track file via <code>&lt;track&gt;</code>, apart from the video bytes it obviously loads. A stylesheet can cause images to load that are used somewhere on the page as background images, as well as web fonts. An <code>&lt;iframe&gt;</code> loads an HTML document. Oh, and the HTML document itself can load manifests, stylesheets, scripts, images, and a ton of other elements like <code>&lt;object&gt;</code> that was quite popular in the past to load Flash movies.</p>
<p><img src="/images/asset-2_____.png" alt="An , two s with background images and triggers for  or , an , and a  with poster image and timed text track"></p>
<p>Coming back to the initial example of the shopping PWA, we could come up with a simple service worker router as outlined in the code below. This router is completely agnostic of the URL structure, so there’s no tight coupling at all.</p>
<pre><code>// In serviceworker.js
self.addEventListener('fetch', (event) =&gt; {
  const destination = event.request.destination;
  switch (destination) {
    case 'style':
    case 'script':
    case 'document':
    case 'image': {
      event.respondWith(
          /* &quot;Network Falling Back to Cache&quot; strategy */);
      return;
    }
    case 'font': {
      event.respondWith(/* &quot;Cache Only&quot; strategy */);
      return;
    }
    // All `XMLHttpRequest` or `fetch()` calls where
    // `Request.destination` is the empty string default value
    default: {
      event.respondWith(/* &quot;Network Only&quot; strategy */);
      return;
    }
  }
});
</code></pre>
<h3 id="browser-support-for-request.destination">Browser Support for <code>Request.destination</code> <a class="direct-link" href="#browser-support-for-request.destination" aria-hidden="true">#</a></h3>
<p><code>Request.destination</code> is universally supported by Chrome, Opera, Firefox, Safari, and Edge. For Chrome, support was added in Chrome 65, so for the unlikely case where your target audience uses older browsers than that, you might want to be careful with fully relying on this feature for your router. Other than that, <code>Request.destination</code> is ready for business. You can see the full details on the corresponding <a href="https://www.chromestatus.com/feature/5629697845100544">Chrome Platform Status page</a>.</p>
<h3 id="when-request.destination-isn%E2%80%99t-enough">When <code>Request.destination</code> isn’t Enough <a class="direct-link" href="#when-request.destination-isn%E2%80%99t-enough" aria-hidden="true">#</a></h3>
<p>If you have more complex caching needs, you will soon realize that <em>purely</em> relying on <code>Request.destination</code> is <em>not</em> enough. For example, all your stylesheets may indeed use the same response strategy (and thus be good candidates for <code>Request.destination</code>), however, your HTML documents or API requests might still require different caching logic the more advanced your app gets.</p>
<p>Fortunately, you can freely combine <code>Request.destination</code> with URL-based pattern matching, there’s absolutely no harm in doing so. A basic example could be to use <code>Request.destination</code> for dealing with all kinds of images to return a default offline fallback placeholder, and to use <code>Request.url</code> with URL-based pattern matching for other resources. You can likewise decide to have different behavior based on the <code>Request.mode</code> of the request, for instance to check if you are dealing with a navigational request (<code>Request.mode === 'navigate'</code>) in single-page apps.</p>
<h3 id="conclusion">Conclusion <a class="direct-link" href="#conclusion" aria-hidden="true">#</a></h3>
<p>Coming up with a reasonable caching strategy for a PWA is hard enough. Having ways to tame this complexity is definitely welcome, so whenever feasible — given your PWA’s structure — in addition to URL-based pattern handling, also consider leveraging <code>Request.destination</code> for your service worker’s routing logic. It may not be able to handle all routes and there are important exceptions and corner cases, but it’s definitely a good idea to reduce the coupling of service worker logic and URL structure as much as possible.</p>
<h3 id="acknowledgements">Acknowledgements <a class="direct-link" href="#acknowledgements" aria-hidden="true">#</a></h3>
<p>Thanks to <a href="https://twitter.com/mathias">Mathias Bynens</a>, <a href="https://twitter.com/jeffposnick">Jeff Posnick</a>, <a href="https://twitter.com/addyosmani">Addy Osmani</a>, <a href="https://twitter.com/rowan_m">Rowan Merewood</a>, and <a href="https://twitter.com/ialbmedina">Alberto Medina</a> for reviewing this article, and again Mathias for his help with debugging emoji encoding in Edge!</p>

</article>


      </main>
    </div>
      <footer id="footer">
        <ul>
          <li>© 2005–2019 <a href="./">Thomas Steiner</a></li>
          <li>Distributed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></li>
          <li>Contact and required <a href="./2005/10/21/thomas-steiners-contact-data-180510">legal info</a></li>
          <li><small>This website uses Google Analytics</small></li>
        </ul>
        <amp-analytics type="googleanalytics">
          <script type="application/json">
            {
              "vars": {
                "account": "UA-2040927-1"
              },
              "triggers": {
                "defaultPageview": {
                  "on": "visible",
                  "request": "pageview"
                }
              }
            }
          </script>
        </amp-analytics>
      </footer>
  </body>
</html>
