<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta property="twitter:account_id" content="1510101733"><meta name="description" content="This is actually talking about a new meta tag &lt;meta name=&quot;color-scheme&quot;&gt; and a CSS property color-scheme that were both proposed in a CSS WG GitHub issue (under the old name supported-color-schemes)‚Ä¶"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><link rel="icon" href="/images/thomas_steiner.jpg"><link rel="canonical" href="/blogccasion/2019/04/03/what-does-dark-modes-color-scheme-actually-do/"><link rel="alternate" href="/blogccasion/feed/feed.xml" type="application/atom+xml" title="Blogccasion"><link rel="author" href="https://tomayac.com/humans.txt" type="text/plain"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet"><script>if (window.matchMedia('(prefers-color-scheme: dark)').media === 'not all') {
        document.documentElement.style.display = 'none';
        document.head.insertAdjacentHTML(
            'beforeend',
            '<link rel="stylesheet" href="/light.css" onload="document.documentElement.style.display = \'\'">'
        );
      }</script><link rel="stylesheet" href="/css/light.css" media="(prefers-color-scheme:light),(prefers-color-scheme:no-preference)"><link rel="stylesheet" href="/css/dark.css" media="(prefers-color-scheme:dark)"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/prism-theme.css"><title>What Does Dark Mode‚Äôs ‚Äúcolor-scheme‚Äù Actually Do?¬†ü§î</title><script type="module" src="/js/script.mjs"></script></head><body><div class="container"><header><a href="/"><h1>blogccasion</h1></a><div class="header-footer-text"><span lang="fr"><strong>l'occasion</strong> <em>f</em> ‚Äî </span><span lang="de">Gelegenheit</span> <em>f</em>, die ~ , der ~; <em>bei Gelegenheit</em> ‚Äî <span lang="fr"><strong>√† l'occasion</strong></span></div></header><nav><h2>Pages</h2><ul><li><a class="nav-item" href="/blogccasion/">Home</a></li><li><a class="nav-item" href="/blogccasion/posts/">Archive</a></li><li><a class="nav-item" href="/blogccasion/about/">About</a></li></ul><h2>Tags</h2><ul><li><a href="/blogccasion/tags/Private/" class="tag">Private</a></li><li><a href="/blogccasion/tags/Technical/" class="tag">Technical</a></li><li><a href="/blogccasion/tags/France/" class="tag">France</a></li><li><a href="/blogccasion/tags/Work/" class="tag">Work</a></li><li><a href="/blogccasion/tags/Political/" class="tag">Political</a></li></ul></nav><svg xmlns="http://www.w3.org/2000/svg"><symbol id="icon-rss" aria-label="RSS" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#f80"/><circle cx="145" cy="367" r="35" fill="#fff"/><path fill="none" stroke="#fff" stroke-width="60" d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"/></symbol><symbol id="icon-twitter" aria-label="Twitter" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1da1f3"/><path fill="#fff" d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></symbol><symbol id="icon-pgp" aria-label="Lock" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#29303d"/><g fill="#29303d"><path stroke="#e0e4eb" stroke-width="32" d="M346 214v-37c0-123-180-123-180 0v37"/><rect fill="#ff0" height="210" rx="5%" width="280" x="115" y="210"/><circle cx="256" cy="296" r="28"/><path d="M262 296h-12l-16 69h44"/></g></symbol><symbol id="icon-github" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></symbol></svg><aside><h2>Related</h2><ul><li><a class="aside-item" href="/blogccasion/feed/feed.xml" rel="me"><svg class="icon"><use xlink:href="#icon-rss"></use></svg> Blog Feed</a></li><li><a class="aside-item" href="https://twitter.com/tomayac" rel="me"><svg class="icon"><use xlink:href="#icon-twitter"></use></svg> Twitter</a></li><li><a class="aside-item" href="https://tomayac.com/tweets" rel="me"><svg class="icon"><use xlink:href="#icon-twitter"></use></svg> Tweet Archive</a></li><li><a class="aside-item" href="https://github.com/tomayac" rel="me"><svg class="icon"><use xlink:href="#icon-github"></use></svg> GitHub</a></li><li><a class="aside-item" href="/pgp_public_key.asc"><svg class="icon"><use xlink:href="#icon-pgp"></use></svg> Public Key</a></li></ul></aside><main class="tmpl-post"><article><header><a href="/blogccasion/2019/04/03/what-does-dark-modes-color-scheme-actually-do/"><h3>What Does Dark Mode‚Äôs ‚Äúcolor-scheme‚Äù Actually Do?¬†ü§î</h3></a><div class="metadata post-date"><img class="author" src="/images/thomas_steiner.jpg" alt="Thomas Steiner headshot"><p>By <a href="/about/">Thomas Steiner</a>. Written on <time datetime="2019-04-03T10:36:26.499Z">Wed Apr 03 2019</time>. <a href="/tags/Technical" class="tag"><b>Technical</b></a></p></div></header><p>The <a href="https://webkit.org/blog/8517/release-notes-for-safari-technology-preview-71/">Release Notes of Safari Technology Preview 71</a> mentioned two new dark mode features:</p><blockquote><p>‚Ä¢ Added experimental support for a <code>supported-color-schemes</code> CSS property (<a href="https://trac.webkit.org/changeset/238001/webkit/">r238001</a>). ‚Ä¢ Changed the default document background and text colors in dark mode and when <code>dark</code> is listed as a <code>supported-color-schemes</code> on the document or body element (<a href="https://trac.webkit.org/changeset/238212/webkit/">r238212</a>).</p></blockquote><p>These were renamed to just <code>color-scheme</code> in <a href="https://webkit.org/blog/8834/release-notes-for-safari-technology-preview-81/">Technology Preview 81</a>:</p><blockquote><p>‚Ä¢ Renamed <code>supported-color-schemes</code> to <code>color-scheme</code> (<a href="https://trac.webkit.org/changeset/244408/webkit/">r244408</a>) ‚Ä¢ Standardized the <code>&lt;meta name=&quot;color-scheme&quot;&gt;</code> separator (<a href="https://trac.webkit.org/changeset/244413/webkit/">r244413</a>)</p></blockquote><p>This is actually talking about a new <strong>meta tag</strong> <code>&lt;meta name=&quot;color-scheme&quot;&gt;</code> and a <strong>CSS property</strong> <code>color-scheme</code> that were both proposed in <a href="https://github.com/w3c/csswg-drafts/issues/3299">a CSS WG GitHub issue</a> (under the old name <code>supported-color-schemes</code>), but the meta tag is now being standardized in the <a href="https://github.com/whatwg/html/issues/4504">WHATWG</a>.</p><h4 id="user-agent-stylesheets">User-Agent stylesheets <a class="direct-link" href="#user-agent-stylesheets">#</a></h4><p>üí° Before I continue, let me briefly describe what a <strong>user-agent stylesheet</strong> is: a user-agent (UA for short) stylesheet determines the default look and feel of a page. As the name suggests, a UA stylesheet is something that is dependent on the UA in question. You can have a look at <a href="https://chromium.googlesource.com/chromium/blink/+/master/Source/core/css/html.css">Chrome‚Äôs (and Chromium‚Äôs) UA stylesheet</a> and compare it to <a href="https://dxr.mozilla.org/mozilla-central/source/layout/style/res/html.css">Firefox‚Äôs</a> or <a href="https://trac.webkit.org/browser/trunk/Source/WebCore/css/html.css">Safari‚Äôs (and WebKit‚Äôs)</a>. Typically, all UA stylesheets agree and make texts black and background colors white, but there are also differences, for example, how to display form controls. Side remark: To overcome these differences, CSS normalizers and CSS resets have become a thing (read this <a href="http://nicolasgallagher.com/about-normalize-css/">article</a> about the difference).</p><p>So let‚Äôs have a closer look at <a href="https://trac.webkit.org/browser/trunk/Source/WebCore/css/html.css">WebKit‚Äôs user-agent stylesheet</a> and what it does regarding dark mode (do a full text search for ‚Äúdark‚Äù in the code). It changes the UA stylesheet‚Äôs default values based on whether dark mode is on or off. To illustrate this, here‚Äôs one such CSS rule (using the¬†<code>[:matches](https://css-tricks.com/almanac/selectors/m/matches/)</code> pseudo class and WebKit-internal variables like <code>-apple-system-control-background,</code> as well as the WebKit-internal preprocessor directive <code>#if defined</code>):</p><pre><code>input,
input:matches([type=&quot;password&quot;], [type=&quot;search&quot;]) {
  -webkit-appearance: textfield;
  #if defined(HAVE_OS_DARK_MODE_SUPPORT) &amp;&amp;
      HAVE_OS_DARK_MODE_SUPPORT
    color: text;
    background-color: -apple-system-control-background;
  #else
    background-color: white;
  #endif
  [‚Ä¶]
}
</code></pre><p>So looking at a concrete example, it changes this light mode experience‚Ä¶</p><p><img src="/images/asset-1-copy.png" alt="Default rendering in light¬†mode"></p><p>‚Ä¶to this dark mode experience‚Ä¶</p><p><img src="/images/asset-2-copy.png" alt="Default rendering in dark¬†mode"></p><p>Note that there is <em>no</em> custom CSS at all included, let alone the <code>@media (prefers-color-scheme)</code> media query. The above is purely based on the UA stylesheet.</p><h4 id="the-meta-tag-%3Cmeta-name%3D%22color-scheme%22%3E-and-the-css-property-%22color-scheme%22">The meta tag <code>&lt;meta name=&quot;color-scheme&quot;&gt; and the CSS property &quot;color-scheme&quot;</code> <a class="direct-link" href="#the-meta-tag-%3Cmeta-name%3D%22color-scheme%22%3E-and-the-css-property-%22color-scheme%22">#</a></h4><p>Now back to the meta tag and the CSS property (that has the same behavior as the meta tag, but optionally limited to just subsections of a page). They both mean that UAs know early in parsing which color scheme is to be used, since this may impact the default appearance, for example, when rendering the default page background, form controls, the default selection color, but also other UA-controlled UI like misspelling underlines. In consequence, this avoids flashes caused by delayed switches between color schemes.</p><p>Here are some of the values the meta tag and the CSS property can take (quoted from <a href="https://github.com/smfr">Simon Fraser</a>‚Äôs <a href="https://github.com/w3c/csswg-drafts/issues/3299#issue-378507535">GitHub Issue text</a>, <em>italic</em> emphasis mine):</p><ul><li><code>light dark</code>‚ÄîThe UA will choose the light or dark theme to match the user‚Äôs preference. <em>If the user‚Äôs preference does not match something in the list, the UA is allowed to apply transformations to the content</em>.</li><li><code>only</code> (synonym for <code>light only</code>‚ÄîThe UA will only ever render the content in the light color scheme, <em>and never apply transformations</em>.</li><li><code>light dark only</code>‚ÄîThe UA will choose the first of the listed schemes that it supports taking user preference into account, <em>and never apply transformations</em>.</li></ul><p>So iff (if, and only if) you know what you‚Äôre doing, in combination with <code>only</code>, you can then design things like your form controls to have no such transformations. In most cases, leaving it to the UA might be the better choice, as you can see in the example below, where, while in dark mode, I force my form controls to look like <code>light only</code>.</p><p><img src="/images/asset-3-copy.png" alt=""><img src="/images/asset-4-copy.png" alt="Left: glaring and without transformations. Right: the easier-on-the-eyes UA¬†default."></p><p>This article was updated to reflect the name change from <code>supported-color-schemes</code> (plural) to <code>color-scheme</code> (singular).</p></article><p>You can <a href="https://github.com/tomayac/blogccasion/tree/master/./posts/2019-04-03_what-does-dark-modes-color-scheme-actually-do.md" rel="nofollow">edit this page on GitHub</a>.</p></main><footer id="footer"><a class="validator" href="https://html5.validator.nu/?doc=https://blog.tomayac.com//blogccasion/2019/04/03/what-does-dark-modes-color-scheme-actually-do/"><img src="/static/validhtml5.svg" width="88" height="31" alt="Valid HTML5 badge"></a><dark-mode-toggle permanent dark="Light Theme" light="Dark Theme"></dark-mode-toggle><ul class="header-footer-text"><li>¬© 2005‚Äì2019 <a class="footer-link" href="/about">Thomas Steiner</a>.</li><li>Distributed under <a class="footer-link" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</li><li>Contact and required <a class="footer-link" href="/about/">legal info</a>.</li></ul></footer></div></body></html>