<!doctype html lang="en">
<html ‚ö°>
  <head>
    <meta charset="utf-8">
    <title>What Does Dark Mode‚Äôs ‚Äúcolor-scheme‚Äù Actually Do?¬†ü§î</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <meta property="twitter:account_id" content="1510101733">
    <meta name="amp-google-client-id-api" content="googleanalytics">
    <meta name="Description" content="This is actually talking about a new meta tag &lt;meta name=&quot;color-scheme&quot;&gt; and a CSS property color-scheme that were both proposed in a CSS WG GitHub issue (under the old name supported-color-schemes)‚Ä¶">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="canonical" href="/blogccasion/2019/04/03/what-does-dark-modes-color-scheme-actually-do/">
    <link rel="alternate" href="/blogccasion/feed/feed.xml" type="application/atom+xml" title="Blogccasion">
    <link type="text/plain" rel="author" href="https://tomayac.com/humans.txt">
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>
      #header,
      #navigation {
        background-color: #eee;
        margin: 0 0 .5em
      }

      #content,
      #header {
        width: 100%;
        max-width: 100%;
        border: 1px dashed silver
      }

      #aside,
      #content,
      #footer,
      #header,
      #navigation {
        border: 1px dashed silver
      }

      #content a,
      #footer a {
        padding: .2em;
        text-decoration: none
      }

      #aside a,
      #content a,
      #content>h3 a,
      #footer a,
      #navigation a {
        text-decoration: none
      }

      #aside a:hover,
      #aside a:link,
      #aside a:visited,
      #content h2,
      #content h3,
      #content>h3 a,
      #footer a,
      body {
        color: #000
      }

      html {
        box-sizing: border-box
      }

      *,
      ::after,
      ::before {
        box-sizing: inherit
      }

      body {
        background-color: #fff;
        font-size: 12pt;
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif
      }

      #blog,
      #ccasion {
        font-size: 1.5em;
        position: absolute;
        font-weight: 700
      }

      #blog {
        top: 0;
        left: 1em;
        z-index: 1;
        color: #ffd700
      }

      #ccasion {
        top: .05em;
        left: 2.12em;
        z-index: 2;
        color: #ff8032
      }

      #login {
        position: absolute;
        top: .05em;
        right: .5em
      }

      #header {
        font-size: 1.2em;
        max-width: 1400px;
        padding: 0;
        overflow: hidden
      }

      #aside h2,
      #navigation h2 {
        font-size: .9em
      }

      #container {
        display: -webkit-flex;
        display: flex;
        margin: 0 .5em;
        max-width: calc(1400px - .5em)
      }

      @media (min-width:480px) {
        #container {
          -webkit-flex-direction: row;
          flex-direction: row
        }
      }

      @media (max-width:480px) {
        #container {
          -webkit-flex-direction: column;
          flex-direction: column
        }
      }

      #navigation-aside {
        display: -webkit-flex;
        display: flex
      }

      @media (min-width:480px) {
        #navigation-aside {
          -webkit-flex-direction: column;
          flex-direction: column
        }
      }

      #navigation {
        width: 120px
      }

      #navigation h2 {
        margin: 0;
        background-color: #ffd700
      }

      #navigation a {
        display: block;
        overflow-x: hidden;
        padding: 0 0 .2em;
        font-weight: 700;
        color: #000
      }

      .category0:hover {
        background-color: #c0c0ff
      }

      .category1:hover {
        background-color: #ff8032
      }

      .category2:hover {
        background-color: #80ff00
      }

      .category3:hover {
        background-color: #ff0080
      }

      .category4:hover {
        background-color: #ff0
      }

      .category5:hover {
        background-color: #80ff80
      }

      .category6:hover {
        background-color: #ff8080
      }

      .category7:hover {
        background-color: #c0ff80
      }

      .category8:hover {
        background-color: #ffc080
      }

      #aside h2,
      #content h2 {
        background-color: #ffd700;
        margin: 0
      }

      #aside a:hover,
      #footer a:hover {
        background-color: #80ffff
      }

      #aside {
        width: 120px;
        margin: 0 .5em .5em 0;
        background-color: #eee;
        overflow-x: hidden
      }

      #aside svg {
        vertical-align: middle
      }

      #aside p {
        margin: .5em
      }

      #aside a {
        display: block;
        padding: 0;
        font-size: 1em;
        font-weight: 400
      }

      #content a,
      #content h2,
      #content h3,
      #footer a {
        font-weight: 700
      }

      #content {
        margin: 0;
      }

      #content h2 {
        font-size: 1.2em
      }

      #content h3 {
        font-size: 1.1em;
        margin: 0;
        background-color: #ff8032
      }

      #content p {
        font-size: 1em;
        margin: .5em 0;
      }

      #content img {
        margin: .5em 1em;
        max-width: 100%;
      }

      #content hr {
        height: 1px;
        text-align: left;
        margin-left: 0;
        border: 1px solid silver
      }

      #content small {
        font-size: .9em;
        padding: .5em 0
      }

      #content a {
        display: inline
      }

      #content a:link {
        color: #00f
      }

      #content a:visited {
        color: #00008b
      }

      #content a:hover {
        color: #00f;
        text-decoration: underline
      }

      #footer {
        max-width: 1400px;
        margin: .5em 0 0;
        padding: .5em
      }

      #footer ul {
        list-style: none
      }

      #footer li::before {
        content: "¬ª "
      }

      .blogPost {
        padding: .5em
      }

      .commentForm,
      .commentList {
        display: none
      }

      ul {
        padding-left: .5em;
        list-style-position: inside
      }

      pre {
        max-width: calc(100% - 1rem);
      }

      code {
        overflow-wrap: break-word;
        word-wrap: break-word;
        word-break: break-word;
      }

      amp-iframe,
      iframe {
        max-width: 533px
      }

      @media (max-width:480px) {
        #navigation-aside {
          -webkit-flex-direction: row;
          flex-direction: row
        }
        #navigation {
          width: 50%
        }
        #aside>amp-img,
        #navigation amp-img {
          -webkit-transform-origin: left;
          -webkit-transform: scaleX(2);
          transform-origin: left;
          transform: scaleX(2)
        }
        #aside {
          width: 50%;
          margin: 0 0 .5em .5em
        }
        amp-iframe,
        amp-img,
        iframe,
        img {
          max-width: 100%;
          layout: responsive
        }
      }

      /**
      * Dracula Theme originally by Zeno Rocha [@zenorocha]
      * https://draculatheme.com/
      *
      * Ported for PrismJS by Albert Vallverdu [@byverdu]
      */

      code[class*="language-"],
      pre[class*="language-"] {
        color: #f8f8f2;
        background: none;
        text-shadow: 0 1px rgba(0, 0, 0, 0.3);
        font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
        text-align: left;
        white-space: pre;
        word-spacing: normal;
        word-break: normal;
        word-wrap: normal;
        line-height: 1.5;
        -moz-tab-size: 4;
        -o-tab-size: 4;
        tab-size: 4;
        -webkit-hyphens: none;
        -moz-hyphens: none;
        -ms-hyphens: none;
        hyphens: none; }

      /* Code blocks */
      pre[class*="language-"] {
        padding: 1em;
        margin: .5em 0;
        overflow: auto;
        border-radius: 0.3em; }

      :not(pre) > code[class*="language-"],
      pre[class*="language-"] {
        background: #282a36; }

      /* Inline code */
      :not(pre) > code[class*="language-"] {
        padding: .1em;
        border-radius: .3em;
        white-space: normal; }

      .token.comment,
      .token.prolog,
      .token.doctype,
      .token.cdata {
        color: #6272a4; }

      .token.punctuation {
        color: #f8f8f2; }

      .namespace {
        opacity: .7; }

      .token.property,
      .token.tag,
      .token.constant,
      .token.symbol,
      .token.deleted {
        color: #ff79c6; }

      .token.boolean,
      .token.number {
        color: #bd93f9; }

      .token.selector,
      .token.attr-name,
      .token.string,
      .token.char,
      .token.builtin,
      .token.inserted {
        color: #50fa7b; }

      .token.operator,
      .token.entity,
      .token.url,
      .language-css .token.string,
      .style .token.string,
      .token.variable {
        color: #f8f8f2; }

      .token.atrule,
      .token.attr-value,
      .token.function,
      .token.class-name {
        color: #f1fa8c; }

      .token.keyword {
        color: #8be9fd; }

      .token.regex,
      .token.important {
        color: #ffb86c; }

      .token.important,
      .token.bold {
        font-weight: bold; }

      .token.italic {
        font-style: italic; }

      .token.entity {
        cursor: help; }

    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
  </head>
  <body>
    <header id="header">
      <a href="/"><amp-img src="/static/city.jpg" alt="" width="1400" height="20"></amp-img></a>
      <a href="/"><div id="blog">blog</div><div id="ccasion">occasion</div></a>
      &nbsp;<strong>l'occasion</strong> <em>f</em> - Gelegenheit <em>f</em>, die ~ , der ~; <em>bei Gelegenheit</em> - <strong>&agrave; l'occasion</strong>
    </header>
    <div id="container">
      <div id="navigation-aside">

        <nav id="navigation">
          <h2>Tags</h2>
          <a href="/"><amp-img src="/static/mountains_sunrise.jpg" alt="" width="120" height="23"></amp-img></a>
          
            
            <a href="/blogccasion/tags/Technical/" class="tag">Technical</a>
          
            
            <a href="/blogccasion/tags/Private/" class="tag">Private</a>
          
            
            <a href="/blogccasion/tags/France/" class="tag">France</a>
          
            
            <a href="/blogccasion/tags/Work/" class="tag">Work</a>
          
            
            <a href="/blogccasion/tags/Political/" class="tag">Political</a>
          

          <h2>Pages</h2>
          <a href="/"><amp-img src="/static/mountains_sunrise.jpg" alt="" width="120" height="23"></amp-img></a><a class="nav-item" href="/blogccasion/">Home</a><a class="nav-item" href="/blogccasion/posts/">Archive</a><a class="nav-item" href="/blogccasion/about/">About</a></nav>

        <aside id="aside">
          <h2>Related</h2>
          <amp-img src="/static/palms.jpg" alt="" width="120" height="23"></amp-img>
          <div>
            <p>
              <a href="/blogccasion/feed/feed.xml" rel="me"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="16" height="16" viewBox="0 0 256 256"><rect width="246" height="246" rx="50" ry="50" x="5" y="5" fill="#F49C52"/><rect width="236" height="236" rx="47" ry="47" x="10" y="10" fill="#F49C52"/><circle cx="68" cy="189" r="24" fill="#FFF"/><path d="M160 213h-34a82 82 0 0 0-82-82v-34a116 116 0 0 1 116 116zM184 213A140 140 0 0 0 44 73V38a175 175 0 0 1 175 175z" fill="#FFF"/></svg> Blog Feed</a>
            </p>
            <p>
               <a href="https://twitter.com/tomayac" rel="me"><svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" height="16" width="16" version="1.1" viewBox="0 0 182.7 150.7"><defs><clipPath clipPathUnits="userSpaceOnUse"><path d="m0 10h1366.9v1110.9h-1366.9z"/></clipPath></defs><g transform="matrix(1.3333 0 0 -1.3333 0 150.67)"><g transform="scale(.1)"><g clip-path="url(#clipPath20)"><path d="m1366.9 989.4c-50.3-22.3-104.3-37.4-161-44.2 57.9 34.7 102.3 89.7 123.3 155.2-54.2-32.1-114.2-55.5-178.1-68-51.1 54.5-124 88.6-204.7 88.6-154.9 0-280.4-125.5-280.4-280.4 0-22 2.5-43.4 7.3-63.9-233.1 11.7-439.7 123.4-578 293-24.1-41.4-38-89.6-38-141 0-97.3 49.5-183.1 124.8-233.4-46 1.4-89.2 14.1-127 35.1 0-1.2 0-2.3 0-3.5 0-135.9 96.7-249.2 225-275-23.5-6.4-48.3-9.8-73.9-9.8-18.1 0-35.6 1.7-52.8 5 35.7-111.4 139.3-192.5 262-194.8-96.1-75.2-217-120-348.4-120-22.6 0-45 1.3-66.9 3.9 124.2-79.6 271.6-126 429.9-126 515.8 0 797.9 427.3 797.9 797.9 0 12.2-0.3 24.2-0.8 36.3 54.8 39.6 102.3 89 139.9 145.2" fill="#55ACEE"/></g></g></g></svg> @tomayac</a>
            </p>
            <p>
               <a href="https://tomayac.com/tweets" rel="me"><svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" height="16" width="16" version="1.1" viewBox="0 0 182.7 150.7"><defs><clipPath clipPathUnits="userSpaceOnUse"><path d="m0 10h1366.9v1110.9h-1366.9z"/></clipPath></defs><g transform="matrix(1.3333 0 0 -1.3333 0 150.67)"><g transform="scale(.1)"><g clip-path="url(#clipPath20)"><path d="m1366.9 989.4c-50.3-22.3-104.3-37.4-161-44.2 57.9 34.7 102.3 89.7 123.3 155.2-54.2-32.1-114.2-55.5-178.1-68-51.1 54.5-124 88.6-204.7 88.6-154.9 0-280.4-125.5-280.4-280.4 0-22 2.5-43.4 7.3-63.9-233.1 11.7-439.7 123.4-578 293-24.1-41.4-38-89.6-38-141 0-97.3 49.5-183.1 124.8-233.4-46 1.4-89.2 14.1-127 35.1 0-1.2 0-2.3 0-3.5 0-135.9 96.7-249.2 225-275-23.5-6.4-48.3-9.8-73.9-9.8-18.1 0-35.6 1.7-52.8 5 35.7-111.4 139.3-192.5 262-194.8-96.1-75.2-217-120-348.4-120-22.6 0-45 1.3-66.9 3.9 124.2-79.6 271.6-126 429.9-126 515.8 0 797.9 427.3 797.9 797.9 0 12.2-0.3 24.2-0.8 36.3 54.8 39.6 102.3 89 139.9 145.2" fill="#55ACEE"/></g></g></g></svg> Tweet Archive</a>
            </p>
            <p>
              <a href="pgp_public_key.asc">üîê PGP Public Key</a>
            </p>
          </div>
        </aside>
      </div>
      <main class="tmpl-post" id="content">
        <h2>A Look Inside the Think Tank...</h2>
        <article class="blogPost">
  <header>
    <a href="/blogccasion/2019/04/03/what-does-dark-modes-color-scheme-actually-do/"><h3>What Does Dark Mode‚Äôs ‚Äúcolor-scheme‚Äù Actually Do?¬†ü§î</h3></a>
    <div>
      <small>
        Created on <b><time datetime="2019-04-03T10:36:26.499Z">Wed Apr 03 2019</time></b>.
      </small>
    </div>
    <div><small>Written by <b>Thomas Steiner</b>.</small></div>
    <hr>
  </header>
  <p>The <a href="https://webkit.org/blog/8517/release-notes-for-safari-technology-preview-71/">Release Notes of Safari Technology Preview 71</a> mentioned two new dark mode features:</p>
<blockquote>
<p>‚Ä¢ Added experimental support for a <code>supported-color-schemes</code> CSS property (<a href="https://trac.webkit.org/changeset/238001/webkit/">r238001</a>).<br>
‚Ä¢ Changed the default document background and text colors in dark mode and when <code>dark</code> is listed as a <code>supported-color-schemes</code> on the document or body element (<a href="https://trac.webkit.org/changeset/238212/webkit/">r238212</a>).</p>
</blockquote>
<p>These were renamed to just <code>color-scheme</code> in <a href="https://webkit.org/blog/8834/release-notes-for-safari-technology-preview-81/">Technology Preview 81</a>:</p>
<blockquote>
<p>‚Ä¢ Renamed <code>supported-color-schemes</code> to <code>color-scheme</code> (<a href="https://trac.webkit.org/changeset/244408/webkit/">r244408</a>)<br>
‚Ä¢ Standardized the <code>&lt;meta name=&quot;color-scheme&quot;&gt;</code> separator (<a href="https://trac.webkit.org/changeset/244413/webkit/">r244413</a>)</p>
</blockquote>
<p>This is actually talking about a new <strong>meta tag</strong> <code>&lt;meta name=&quot;color-scheme&quot;&gt;</code> and a <strong>CSS property</strong> <code>color-scheme</code> that were both proposed in <a href="https://github.com/w3c/csswg-drafts/issues/3299">a CSS WG GitHub issue</a> (under the old name <code>supported-color-schemes</code>), but the meta tag is now being standardized in the <a href="https://github.com/whatwg/html/issues/4504">WHATWG</a>.</p>
<h4 id="user-agent-stylesheets">User-Agent stylesheets <a class="direct-link" href="#user-agent-stylesheets" aria-hidden="true">#</a></h4>
<p>üí° Before I continue, let me briefly describe what a <strong>user-agent stylesheet</strong> is: a user-agent (UA for short) stylesheet determines the default look and feel of a page. As the name suggests, a UA stylesheet is something that is dependent on the UA in question. You can have a look at <a href="https://chromium.googlesource.com/chromium/blink/+/master/Source/core/css/html.css">Chrome‚Äôs (and Chromium‚Äôs) UA stylesheet</a> and compare it to <a href="https://dxr.mozilla.org/mozilla-central/source/layout/style/res/html.css">Firefox‚Äôs</a> or <a href="https://trac.webkit.org/browser/trunk/Source/WebCore/css/html.css">Safari‚Äôs (and WebKit‚Äôs)</a>. Typically, all UA stylesheets agree and make texts black and background colors white, but there are also differences, for example, how to display form controls. Side remark: To overcome these differences, CSS normalizers and CSS resets have become a thing (read this <a href="http://nicolasgallagher.com/about-normalize-css/">article</a> about the difference).</p>
<p>So let‚Äôs have a closer look at <a href="https://trac.webkit.org/browser/trunk/Source/WebCore/css/html.css">WebKit‚Äôs user-agent stylesheet</a> and what it does regarding dark mode (do a full text search for ‚Äúdark‚Äù in the code). It changes the UA stylesheet‚Äôs default values based on whether dark mode is on or off. To illustrate this, here‚Äôs one such CSS rule (using the¬†<code>[:matches](https://css-tricks.com/almanac/selectors/m/matches/)</code> pseudo class and WebKit-internal variables like <code>-apple-system-control-background,</code> as well as the WebKit-internal preprocessor directive <code>#if defined</code>):</p>
<pre><code>input,
input:matches([type=&quot;password&quot;], [type=&quot;search&quot;]) {
  -webkit-appearance: textfield;
  #if defined(HAVE_OS_DARK_MODE_SUPPORT) &amp;&amp;
      HAVE_OS_DARK_MODE_SUPPORT
    color: text;
    background-color: -apple-system-control-background;
  #else
    background-color: white;
  #endif
  [‚Ä¶]
}
</code></pre>
<p>So looking at a concrete example, it changes this light mode experience‚Ä¶</p>
<p><img src="/images/asset-1-copy.png" alt="Default rendering in light¬†mode"></p>
<p>‚Ä¶to this dark mode experience‚Ä¶</p>
<p><img src="/images/asset-2-copy.png" alt="Default rendering in dark¬†mode"></p>
<p>Note that there is <em>no</em> custom CSS at all included, let alone the <code>@media (prefers-color-scheme)</code> media query. The above is purely based on the UA stylesheet.</p>
<h4 id="the-meta-tag-%3Cmeta-name%3D%22color-scheme%22%3E-and-the-css-property-%22color-scheme%22">The meta tag <code>&lt;meta name=&quot;color-scheme&quot;&gt; and the CSS property &quot;color-scheme&quot;</code> <a class="direct-link" href="#the-meta-tag-%3Cmeta-name%3D%22color-scheme%22%3E-and-the-css-property-%22color-scheme%22" aria-hidden="true">#</a></h4>
<p>Now back to the meta tag and the CSS property (that has the same behavior as the meta tag, but optionally limited to just subsections of a page). They both mean that UAs know early in parsing which color scheme is to be used, since this may impact the default appearance, for example, when rendering the default page background, form controls, the default selection color, but also other UA-controlled UI like misspelling underlines. In consequence, this avoids flashes caused by delayed switches between color schemes.</p>
<p>Here are some of the values the meta tag and the CSS property can take (quoted from <a href="https://github.com/smfr">Simon Fraser</a>‚Äôs <a href="https://github.com/w3c/csswg-drafts/issues/3299#issue-378507535">GitHub Issue text</a>, <em>italic</em> emphasis mine):</p>
<ul>
<li><code>light dark</code>‚ÄîThe UA will choose the light or dark theme to match the user‚Äôs preference. <em>If the user‚Äôs preference does not match something in the list, the UA is allowed to apply transformations to the content</em>.</li>
<li><code>only</code> (synonym for <code>light only</code>‚ÄîThe UA will only ever render the content in the light color scheme, <em>and never apply transformations</em>.</li>
<li><code>light dark only</code>‚ÄîThe UA will choose the first of the listed schemes that it supports taking user preference into account, <em>and never apply transformations</em>.</li>
</ul>
<p>So iff (if, and only if) you know what you‚Äôre doing, in combination with <code>only</code>, you can then design things like your form controls to have no such transformations. In most cases, leaving it to the UA might be the better choice, as you can see in the example below, where, while in dark mode, I force my form controls to look like <code>light only</code>.</p>
<p><img src="/images/asset-3-copy.png" alt=""><img src="/images/asset-4-copy.png" alt="Left: glaring and without transformations. Right: the easier-on-the-eyes UA¬†default."></p>
<p>This article was updated to reflect the name change from <code>supported-color-schemes</code> (plural) to <code>color-scheme</code> (singular).</p>

</article>


      </main>
    </div>
      <footer id="footer">
        <ul>
          <li>¬© 2005‚Äì2019 <a href="./">Thomas Steiner</a></li>
          <li>Distributed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></li>
          <li>Contact and required <a href="/about/">legal info</a></li>
          <li><small>This website uses Google Analytics</small></li>
        </ul>
        <amp-analytics type="googleanalytics">
          <script type="application/json">
            {
              "vars": {
                "account": "UA-2040927-1"
              },
              "triggers": {
                "defaultPageview": {
                  "on": "visible",
                  "request": "pageview"
                }
              }
            }
          </script>
        </amp-analytics>
      </footer>
  </body>
</html>
